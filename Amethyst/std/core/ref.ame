namespace amethyst:core/ref;

string get-stack-ref(unsafe_string name, int offset) {
    offset += amethyst:stack.size() - 1;

    // TODO: string concatenation
    string ref;
    @/data modify $(^ref) set value "storage amethyst:runtime stack[$(offset)].$(name)"
    
    return ref;
}

inline void set-ref(macro nbt^ ref, macro nbt^ val) {
    @/data modify $(ref) set from $(val)
}
