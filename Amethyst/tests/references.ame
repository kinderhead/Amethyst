namespace test;

#test
void test_int_ref() {
    start("int ref");
    
    int x = 10;
    int& ref = x;

    ref = -4;

    assert_eq(x, -4);
    assert_eq(ref, -4);

    complete();
}

#test
void test_int_2_ref() {
    start("int 2 ref");
    
    int x = 10;
    int y = -3;
    int& ref1 = x;
    int& ref2 = y;

    ref1 = ref2;

    assert_eq(x, -3);
    assert_eq(y, -3);
    assert_eq(ref1, -3);
    assert_eq(ref2, -3);

    complete();
}

#test
void test_int_weak_ref() {
    start("int weak ref");
    
    int x = 10;
    int^ ref = x;

    ref = -4;

    assert_eq(x, -4);
    assert_eq(ref, -4);

    complete();
}

#test
void test_int_2_weak_ref() {
    start("int 2 weak ref");
    
    int x = 10;
    int y = -3;
    int^ ref1 = x;
    int^ ref2 = y;

    ref1 = ref2;

    assert_eq(x, -3);
    assert_eq(y, -3);
    assert_eq(ref1, -3);
    assert_eq(ref2, -3);

    complete();
}

#test 
void test_int_arg_ref() {
    start("int arg ref");

    int x = 75;

    assert_eq(x, 75);
    _modify(x);
    assert_eq(x, -9);

    complete();
}

void _modify(int& ref) {
    int _dummy = 9;

    assert_eq(ref, 75);
    ref = -9;
    assert_eq(ref, -9);
}

#test 
void test_int_arr_ref() {
    start("int arr ref");

    int[] arr;
    arr.add(10);

    int[]& ref = arr;
    assert_eq(ref[0], 10);

    int x = 0;
    assert_eq(ref[x], 10);

    complete();
}

